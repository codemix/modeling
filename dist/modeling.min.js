!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Modeling=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";var Classing=_dereq_("classing"),Casting=_dereq_("casting"),Validating=_dereq_("validating");var Modeling=Classing.extend({makeConstructor:function(name){var body="return function "+name+" (config) {"+"  if (!(this instanceof "+name+")) {"+"    return new "+name+"(config);"+"  }"+'  Object.defineProperty(this, "__state__", {value: {}});'+"  this.applyDefaults();"+"  if (config) { this.configure(config); }"+"  this.initialize();"+"};";return new Function(body)()},makePrototype:function(Class,descriptors){Classing.makePrototype.call(this,Class,descriptors);Object.defineProperties(Class.prototype,{__state__:{enumerable:false,writable:true}})},makeStatic:{value:function(Class,descriptors){var Modeling=this;Classing.makeStatic.call(this,Class,descriptors);var defineProperty=Class.defineProperty;Object.defineProperties(Class,{defineProperty:{configurable:true,value:function(name,descriptor,skipReload){var cast;if(name!=="__state__"&&descriptor&&descriptor.type&&!descriptor.hasOwnProperty("get")&&!descriptor.hasOwnProperty("set")&&!descriptor.hasOwnProperty("value")){cast=Casting.get(descriptor.type);descriptor.enumerable=true;descriptor.configurable=true;descriptor.get=function(){return this.__state__[name]};descriptor.set=function(value){this.__state__[name]=cast(value)}}return defineProperty.call(this,name,descriptor,skipReload)}},updateAutoGeneratedFunctions:{configurable:true,value:function(){if(!this.prototype.applyDefaults||this.prototype.applyDefaults.isAutoGenerated){this.prototype.applyDefaults=this.makeApplyDefaults(descriptors)}if(!this.prototype.configure||this.prototype.configure.isAutoGenerated){this.prototype.configure=this.makeConfigure(descriptors)}if(!this.prototype.toJSON||this.prototype.toJSON.isAutoGenerated){this.prototype.toJSON=this.makeToJSON(descriptors)}if(!this.prototype.forEach||this.prototype.forEach.isAutoGenerated){this.prototype.forEach=this.makeForEach(descriptors)}if(!this.prototype.keys||this.prototype.keys.isAutoGenerated){this.prototype.keys=this.makeKeys(descriptors)}if(!this.cast||this.cast.isAutoGenerated){this.cast=this.makeCast(descriptors)}if(!this.input||this.input.isAutoGenerated){this.input=this.makeInput(descriptors)}if(!this.validate||this.validate.isAutoGenerated){this.validate=this.makeValidate(descriptors)}if(!this.toJSON||this.toJSON.isAutoGenerated){this.toJSON=this.makeStaticToJSON(descriptors)}}},makeCast:{configurable:true,value:function(descriptors){var castAll=Casting.forDescriptors(descriptors),fn=function(value){if(!(value instanceof this)){return new this(value)}else{return castAll(value)}};fn.isAutoGenerated=true;return fn}},makeValidate:{configurable:true,value:function(descriptors){var validate=Validating.forDescriptors(descriptors);validate.isAutoGenerated=true;return validate}},makeInput:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,casters={},validators={},body='"use strict";\n',accessor,key,descriptor,i;body+="var valid = true, errors = {}, result;\n"+"if (values === undefined) { values = subject || {}; subject = new this(); }\n";for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(key==="__state__"||key==="initialize"||!descriptor.writable&&!descriptor.hasOwnProperty("set")){continue}if(/^([\w|_|$]+)$/.test(key)){accessor="."+key}else{accessor='["'+key+'"]'}body+="if (values"+accessor+" !== undefined) {\n";if(descriptor.type){casters[key]=Casting.get(descriptor.type);body+="  if (values"+accessor+" === null) {\n";body+="     values"+accessor+" = null;\n";body+="  }\n";body+="  else {\n";body+="    result = tryCatch1(casters"+accessor+", values"+accessor+");\n";body+="    if (result.error) {\n";body+="       valid = false;\n";body+="       errors"+accessor+" = result.error.message;\n";body+="    }\n";body+="    else {\n";body+="      subject"+accessor+" = result.value;\n";body+="    }\n";body+="  }\n"}else{body+="  subject"+accessor+" = values"+accessor+";\n"}body+="}\n";if(descriptor.rules){validators[key]=Validating.forDescriptor(key,descriptor);body+="if (!errors"+accessor+") {\n";body+="  result = validators"+accessor+"(subject"+accessor+");\n";body+="  if (!result.valid) {\n";body+="    valid = false;\n";body+="    errors"+accessor+" = result.error;\n";body+="  }\n";body+="}\n"}}body+="return {valid: valid, value: subject, errors: errors};";var fn=new Function("validators","casters","tryCatch1","subject","values",body);fn=fn.bind(this,validators,casters,tryCatch1);fn.isAutoGenerated=true;return fn}},makeConfigure:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,casters={},body="",accessor,key,descriptor,i;for(i=0;i<total;i++){key=keys[i];if(key==="__state__"){continue}descriptor=descriptors[key];if(descriptor.writable||descriptor.hasOwnProperty("set")){if(/^([\w|_|$]+)$/.test(key)){accessor="."+key}else{accessor='["'+key+'"]'}body+="if (config"+accessor+" !== undefined) {\n";body+="  this"+accessor+" = config"+accessor+";\n";body+="}"}}var fn=new Function("casters","config",body);var configure=function(config){return fn.call(this,casters,config)};configure.isAutoGenerated=true;return configure}},makeForEach:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,body="thisContext = thisContext || this;\n",accessor,key,descriptor,i;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(!descriptor.enumerable){continue}if(/^([\w|_|$]+)$/.test(key)){accessor="."+key}else{accessor='["'+key+'"]'}body+="if (this"+accessor+" !== undefined) { fn.call(thisContext, this"+accessor+', "'+key+'", this); }\n'}var forEach=new Function("fn","thisContext",body);forEach.isAutoGenerated=true;return forEach}},makeKeys:{configurable:true,value:function(descriptors){var names=Object.keys(descriptors).sort(),total=names.length,items=[],name,descriptor,i;for(i=0;i<total;i++){name=names[i];descriptor=descriptors[name];if(descriptor.enumerable){items.push(name)}}var keys=function(){return items};keys.isAutoGenerated=true;return keys}},makeStaticToJSON:{configurable:true,value:function(descriptors){var names=Object.keys(descriptors).sort(),totalNames=names.length,properties={},property,name,descriptor,i,keys,totalKeys,key,j;for(i=0;i<totalNames;i++){name=names[i];descriptor=descriptors[name];if(descriptor.enumerable){keys=Object.keys(descriptor);totalKeys=keys.length;property={};properties[name]=property;for(j=0;j<totalKeys;j++){key=keys[j];switch(key){case"enumerable":case"configurable":case"writable":case"get":case"set":case"value":break;case"default":if(typeof descriptor.default!=="function"){property.default=descriptor.default}break;case"rules":property.rules=descriptor.rules.map(function(item){var name;if(Array.isArray(item)){name=item[0];item=item[1]||{};item.name=name;return item}else{return item}});break;default:property[key]=descriptor[key]}}}}var toJSON=function(){return{"@context":this["@context"],"@id":this["@id"],"@type":this["@type"]||this.name,name:this.name,properties:properties}};toJSON.isAutoGenerated=true;return toJSON}}})}}});module.exports=Modeling;function tryCatch1(fn,arg1){var errorObject={};try{errorObject.value=fn(arg1)}catch(e){errorObject.error=e}return errorObject}},{casting:2,classing:3,validating:4}],2:[function(_dereq_,module,exports){"use strict";exports.casters=[];exports.define=function(name,Constructor,caster){if(!caster){caster=function(value){return new Constructor(value)}}exports.casters.push([name,Constructor,caster]);return exports};exports.get=function(type){var casters=exports.casters,total=casters.length,item,i;for(i=0;i<total;i++){item=casters[i];if(type===item[0]||type===item[1]){return item[2]}}};exports.cast=function(type,value){var caster=exports.get(type);if(!caster){throw new TypeError("Cannot cast to unknown type: "+type)}return caster(value)};exports.forDescriptors=function(descriptors){var names=Object.keys(descriptors),total=names.length,lines=[],casters={},accessor,descriptor,name,i;for(i=0;i<total;i++){name=names[i];descriptor=descriptors[name];if(/^([\w|_|$]+)$/.test(name)){accessor="."+name}else{accessor='["'+name+'"]'}if(descriptor.type){casters[name]=exports.get(descriptor.type);lines.push("if (object"+accessor+" != null) {","  object"+accessor+" = casters"+accessor+"(object"+accessor+");","}")}}lines.push("return object;");return new Function("casters","object",lines.join("\n")).bind(undefined,casters)};exports.define("array",Array,function(value){if(!Array.isArray(value)){return[value]}else{return value}});exports.define("string",String,function(value){return""+value});exports.define("number",Number,function(value){return+value});exports.define("boolean",Boolean,function(value){return+value?true:false});exports.define("regexp",RegExp,function(value){if(value instanceof RegExp){return value}else if(typeof value==="string"){return new RegExp(value)}else{throw new TypeError("Cannot cast value to RegExp")}});exports.define("object",Object,function(value){return Object(value)});exports.define("date",Date,function(value){if(!(value instanceof Date)){value=new Date(value)}if(isNaN(value.valueOf())){throw new TypeError("Invalid date value")}return value})},{}],3:[function(_dereq_,module,exports){"use strict";function Classing(name,descriptors){return Classing.create(name,descriptors)}module.exports=exports=Classing;Classing.create=function(name,descriptors){if(name&&typeof name==="string"){descriptors=descriptors||{}}else{descriptors=name||{};name="Class"}var Class=this.makeConstructor(name);this.makeStatic(Class,descriptors);this.makePrototype(Class,descriptors);return Class};Classing.makeConstructor=function(name){var body="return function "+name+" (config) {"+"  if (!(this instanceof "+name+")) {"+"    return new "+name+"(config);"+"  }"+"  this.applyDefaults();"+"  if (config) { this.configure(config); }"+"  this.initialize();"+"};";return new Function(body)()};Classing.makeStatic=function(Class,descriptors){var Classing=this;Object.defineProperties(Class,{create:{configurable:true,value:function(properties){return new Class(properties)}},descriptors:{value:descriptors},defineProperty:{configurable:true,value:function(name,descriptor,skipReload){descriptor=descriptor||{value:null};if(typeof descriptor==="function"){descriptor={enumerable:false,configurable:true,writable:true,value:descriptor}}if(descriptor.value===undefined&&!(descriptor.get||descriptor.set)){descriptor.value=null}if(descriptor.writable==null&&descriptor.value!==undefined){descriptor.writable=true}if(descriptor.enumerable==null){descriptor.enumerable=true}if(descriptor.configurable==null){descriptor.configurable=true}descriptors[name]=descriptor;Object.defineProperty(this.prototype,name,descriptor);if(!skipReload){this.updateAutoGeneratedFunctions()}return this}},defineProperties:{configurable:true,value:function(items){if(!items){return this}var keys=Object.keys(items),total=keys.length,key,i;for(i=0;i<total;i++){key=keys[i];this.defineProperty(key,items[key],true)}this.updateAutoGeneratedFunctions();return this}},inherits:{configurable:true,value:function(Super){var keys=Object.keys(Super),total=keys.length,key,i;for(i=0;i<total;i++){key=keys[i];if(!this.hasOwnProperty(key)){this[key]=Super[key]}}var superDescriptors=Super.descriptors||{};keys=Object.keys(superDescriptors);total=keys.length;for(i=0;i<total;i++){key=keys[i];if(!descriptors.hasOwnProperty(key)){descriptors[key]=superDescriptors[key]}}descriptors.__super__={enumerable:false,value:Super.prototype};this.__super__=Super;this.prototype=Object.create(Super.prototype,descriptors);this.prototype.constructor=this;if(!descriptors.hasOwnProperty("toString")){Object.defineProperty(Class.prototype,"toString",{configurable:true,writable:true,value:Class.makeToString(descriptors)})}this.updateAutoGeneratedFunctions();return this}},extend:{configurable:true,value:function(name,config){var Child=Classing.create(name,config);Child.inherits(this);return Child}},mixin:{configurable:true,value:function(source){var keys=Object.keys(source),total=keys.length,combined={},key,i;for(i=0;i<total;i++){key=keys[i];combined[key]={value:source[key]}}this.defineProperties(combined);return this}},updateAutoGeneratedFunctions:{configurable:true,value:function(){if(!this.prototype.applyDefaults||this.prototype.applyDefaults.isAutoGenerated){this.prototype.applyDefaults=this.makeApplyDefaults(descriptors)}if(!this.prototype.configure||this.prototype.configure.isAutoGenerated){this.prototype.configure=this.makeConfigure(descriptors)}if(!this.prototype.toJSON||this.prototype.toJSON.isAutoGenerated){this.prototype.toJSON=this.makeToJSON(descriptors)}}},makeApplyDefaults:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,body="",key,descriptor,i,suffix,value;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.hasOwnProperty("default")){suffix="";if(typeof descriptor.default==="function"){suffix="(this)"}if(/^([\w|_|$]+)$/.test(key)){body+="this."+key+" = this.constructor.descriptors."+key+".default"+suffix+";"}else{body+='this["'+key+'"] = this.constructor.descriptors["'+key+'"].default'+suffix+";"}}else if(descriptor.bind){if(/^([\w|_|$]+)$/.test(key)){if(descriptor.bind===true){value="this"}else{value="this.constructor.descriptors."+key+".bind"}body+="this."+key+" = this."+key+".bind("+value+");"}else{if(descriptor.bind===true){value="this"}else{value='this.constructor.descriptors["'+key+'"].bind'}body+='this["'+key+'"] = this["'+key+'"].bind('+value+");"}}}var applyDefaults=new Function(body);applyDefaults.isAutoGenerated=true;return applyDefaults}},makeConfigure:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,body="",key,descriptor,i;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.writable||descriptor.hasOwnProperty("set")){if(/^([\w|_|$]+)$/.test(key)){body+="this."+key+" = config."+key+" !== undefined ? config."+key+" : this."+key+";"}else{body+='this["'+key+'"] = config["'+key+'"] !== undefined ? config["'+key+'"] : this["'+key+'"];'}}}var configure=new Function("config",body);configure.isAutoGenerated=true;return configure}},makeToJSON:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors).sort(),total=keys.length,parts=[],key,descriptor,i;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.enumerable||descriptor.enumerable==null){if(/^([\w|_|$]+)$/.test(key)){parts.push(key+": this."+key)}else{parts.push('"'+key+'": this["'+key+'"]')}}}var toJSON=new Function("return {"+parts.join(",")+"};");toJSON.isAutoGenerated=true;return toJSON}},makeToString:{configurable:true,value:function(){var fn=new Function('return "[object '+this.name+']";');fn.isAutoGenerated=true;return fn}}})};Classing.makePrototype=function(Class,descriptors){if(!descriptors.initialize){descriptors.initialize=function(){}}Class.defineProperties(descriptors);Class.updateAutoGeneratedFunctions();if(!descriptors.hasOwnProperty("toString")){Object.defineProperty(Class.prototype,"toString",{configurable:true,writable:true,value:Class.makeToString(descriptors)})}};Classing.extend=function(descriptors){descriptors=descriptors||{};function Child(name,descriptors){return Child.create(name,descriptors)}var keys=Object.keys(this),total=keys.length,i,key;for(i=0;i<total;i++){key=keys[i];Child[key]=this[key]}keys=Object.keys(descriptors);total=keys.length;for(i=0;i<total;i++){key=keys[i];if(typeof descriptors[key]==="function"){descriptors[key]={configurable:true,value:descriptors[key]}}}Object.defineProperties(Child,descriptors);Child.super=this;return Child}},{}],4:[function(_dereq_,module,exports){var OBLIGATIONS=_dereq_("obligations");"use strict";exports.Validator=_dereq_("./validator");exports.validators=Object.create(null);exports.define=function(name,descriptors){if(typeof descriptors==="function"){exports.validators[name]=descriptors}else{exports.validators[name]=exports.Validator.extend(descriptors)}return exports.validators[name]};exports.create=function(name,properties){return exports.validators[name].create(properties)};exports.forDescriptor=function(name,descriptor){OBLIGATIONS.precondition(name&&typeof name==="string","Name must be specified.");OBLIGATIONS.precondition(descriptor&&typeof descriptor==="object","Descriptor must be an object.");if(!Array.isArray(descriptor.rules)){return null}var validators=[],accessor=/^([\w|_|$]+)$/.test(name)?"."+name:'["'+name+'"]',lines;lines=descriptor.rules.map(processRule).map(function(validator){var index=validators.push(validator)-1;return"if ((result = validators["+index+"].validate(value)) !== true) {\n"+"  isValid = false;\n"+"  error = result;\n"+"}\n"});var body="var isValid = true,\n"+"    error, result;\n\n"+lines.join("else ")+"\n"+"return {valid: isValid, error: error};";var fn=new Function("validators","value",body);return fn.bind(undefined,validators)};exports.forDescriptors=function(descriptors){OBLIGATIONS.precondition(descriptors&&typeof descriptors==="object","Descriptors must be an object.");var __result;var names=Object.keys(descriptors).sort(),total=names.length,validators={},lines=[],descriptor,name,items,i,accessor;for(i=0;i<total;i++){name=names[i];descriptor=descriptors[name];if(/^([\w|_|$]+)$/.test(name)){accessor="."+name}else{accessor='["'+name+'"]'}if(descriptor.rules){validators[name]=this.forDescriptor(name,descriptor);lines.push("if (!(result = validators"+accessor+"(obj"+accessor+")).valid) {","  isValid = false;","  errors"+accessor+" = result.error;","}")}}var body="var isValid = true,\n"+"    errors = {},\n"+"    result;\n\n"+lines.join("\n")+"\n"+"return {valid: isValid, errors: errors};";var fn=new Function("validators","obj",body);__result=fn.bind(undefined,validators);OBLIGATIONS.postcondition(typeof __result==="function");return __result};function processRule(rule){if(typeof rule!=="function"&&typeof rule!=="string"){OBLIGATIONS.precondition(Array.isArray(rule)&&rule[0]||rule.name,"Validator name must be specified.")}var __result;main:{if(typeof rule==="string"){__result=exports.create(rule);break main}else if(typeof rule==="function"){__result=new exports.Validator({validate:rule});break main}else if(Array.isArray(rule)){__result=exports.create.apply(exports,rule);break main}else{__result=exports.create(rule.name,rule);break main}}OBLIGATIONS.postcondition(__result instanceof exports.Validator);return __result}var validators=_dereq_("./validators"),names=Object.keys(validators),total=names.length,name,i;for(i=0;i<total;i++){name=names[i];exports.define(name,validators[name])}},{"./validator":5,"./validators":6,obligations:7}],5:[function(_dereq_,module,exports){var OBLIGATIONS=_dereq_("obligations");"use strict";var Class=_dereq_("classing");module.exports=Class.create({messages:{"default":function(){return{"default":"Invalid value."}}},message:{get:function(){return this.messages.default},set:function(value){this.messages.default=value}},allowEmpty:{value:true},isEmpty:function(value){if(value==null||value===""){return true}else if(Array.isArray(value)&&value.length===0){return true}else if(typeof value==="object"&&Object.keys(value).length===0){return!value.constructor||value.constructor===Object}else{return false}},prepare:function(message,references){OBLIGATIONS.precondition(typeof message==="string","Message must be a string.");if(references){OBLIGATIONS.precondition(typeof references==="object","References must be an object.")}references=references||this;return message.replace(/\{\{(\w+)\}\}/g,function(token,item){return references[item]||""})},validate:function(value){return true}})},{classing:3,obligations:7}],6:[function(_dereq_,module,exports){var OBLIGATIONS=_dereq_("obligations");"use strict";exports.required={allowEmpty:{value:false},messages:{"default":function(){return{"default":"Cannot be empty."}}},validate:function(value){if(this.isEmpty(value)){return this.prepare(this.message)}else{return true}}};exports.type={messages:{"default":function(){return{"default":"Expected {{expected}}, got {{got}}."}}},type:{value:"string"},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}var expected=this.type,got=typeof value;if(expected==="null"&&value===null){return true}else if(expected===got){return true}else{return this.prepare(this.message,{got:got,expected:expected})}}};exports.instanceOf={messages:{"default":function(){return{"default":"Expected {{expected}}, got {{got}}."}}},"class":{},className:{get:function(){OBLIGATIONS.precondition(this.class,"Class must be specified");OBLIGATIONS.precondition(typeof this.class==="string"||typeof this.class==="function","Class must be a string or a function.");return typeof this.class==="string"?this.class:this.class.name}},validate:function(value){OBLIGATIONS.precondition(this.class,"Class must be specified");OBLIGATIONS.precondition(typeof this.class==="string"||typeof this.class==="function","Class must be a string or a function.");if(this.allowEmpty&&this.isEmpty(value)){return true}var className=this.className,references;if(!value||typeof value!=="object"||!value.constructor){references={expected:className,got:value===null?"null":typeof value}}else{if(typeof this.class==="function"){if(value instanceof this.class){return true}}else if(value.constructor.name===className){return true}references={expected:className,got:value.constructor.name}}return this.prepare(this.message,references)}};exports.length={messages:{"default":function(){return{invalid:"The value is invalid.",tooShortString:"Too short, should be at least {{min}} character(s).",tooLongString:"Too long, should be at most {{max}} character(s).",tooShortArray:"Too short, should contain at least {{min}} item(s).",tooLongArray:"Too long, should contain at most {{max}} item(s).",tooShortObject:"Too short, should contain at least {{min}} key(s).",tooLongObject:"Too long, should contain at most {{max}} key(s)."}}},min:{},max:{},validate:function(value){OBLIGATIONS.precondition(this.min||this.max,"No constraints specified for length validator.");if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value==="string"){return this.validateString(value)}else if(Array.isArray(value)){return this.validateArray(value)}else if(value&&typeof value==="object"){return this.validateObject(value)}else{return this.prepare(this.messages.invalid)}},validateString:function(value){OBLIGATIONS.precondition(typeof value==="string","Value must be a string.");if(this.min&&value.length<this.min){return this.prepare(this.messages.tooShortString)}else if(this.max&&value.length>this.max){return this.prepare(this.messages.tooLongString)}else{return true}},validateArray:function(value){OBLIGATIONS.precondition(Array.isArray(value),"Value must be an array.");if(this.min&&value.length<this.min){return this.prepare(this.messages.tooShortArray)}else if(this.max&&value.length>this.max){return this.prepare(this.messages.tooLongArray)}else{return true}},validateObject:function(value){OBLIGATIONS.precondition(value&&typeof value==="object","Value must be an object.");var keys=Object.keys(value);if(this.min&&keys.length<this.min){return this.prepare(this.messages.tooShortObject)}else if(this.max&&keys.length>this.max){return this.prepare(this.messages.tooLongObject)}else{return true}}};exports.number={messages:{"default":function(){return{invalid:"Expected a number.",tooSmall:"Must be at least {{min}}.",tooLarge:"Must be at most {{max}}."}}},min:{},max:{},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value!=="number"||isNaN(value)){return this.prepare(this.messages.invalid)}else if(this.min&&value<this.min){return this.prepare(this.messages.tooSmall)}else if(this.max&&value>this.max){return this.prepare(this.messages.tooLarge)}else{return true}}};exports.boolean={messages:{"default":function(){return{"default":"Must be true or false."}}},trueValues:{"default":function(){return[true]}},falseValues:{"default":function(){return[false]}},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(~this.trueValues.indexOf(value)){return true}else if(~this.falseValues.indexOf(value)){return true}else{return this.prepare(this.message)}}};exports.regexp={messages:{"default":function(){return{"default":"Does not match the required pattern.",badType:"Should be a text value."}}},pattern:{get:function(){return this._pattern||new RegExp},set:function(value){if(typeof value==="string"){value=new RegExp(value)}this._pattern=value}},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value!=="string"){return this.prepare(this.messages.badType)}else if(this.pattern.test(value)){return true}else{return this.prepare(this.message)}}};exports.range={messages:{"default":function(){return{between:"Must be between {{start}} and {{stop}}.","in":"Not in the list of valid options."}}},"in":{},between:{},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(this.between){return this.validateBetween(value)}else if(this.in){return this.validateIn(value)}else{return true}},validateBetween:function(value){OBLIGATIONS.precondition(Array.isArray(this.between)&&this.between.length===2,"`between` must be an array containing two values.");if(value>=this.between[0]&&value<=this.between[1]){return true}else{return this.prepare(this.messages.between,{start:this.between[0],stop:this.between[1]})}},validateIn:function(value){OBLIGATIONS.precondition(Array.isArray(this.in),"`in` must be an array");if(~this.in.indexOf(value)){return true}else{return this.prepare(this.messages.in)}}};exports.url={messages:{"default":function(){return{"default":"Not a valid URL."}}},schemes:{"default":function(){return["http","https"]}},strict:{value:true},pattern:{get:function(){if(!this._pattern){this._pattern=this.createPattern()}return this._pattern},set:function(value){if(typeof value==="string"){value=new RegExp(value,"i")}this._pattern=value}},createPattern:function(){var pattern="^(({schemes}):\\/\\/)?(([A-Z0-9][A-Z0-9_-]*)(\\.[A-Z0-9][A-Z0-9_-]*)+)".replace("{schemes}",this.schemes.join("|"));return new RegExp(pattern,"i")},validate:function(value){var matches;if(this.allowEmpty&&this.isEmpty(value)){return true}else if(!(matches=this.pattern.exec(value))){return this.prepare(this.message)}if(this.strict&&!matches[1]){return this.prepare(this.message)}else{return true}}};exports.email={messages:{"default":function(){return{"default":"Not a valid email address."}}},pattern:{value:/@(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)$/i},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(this.pattern.test(value)){return true}else{return this.prepare(this.message)}}};exports.ip={messages:{"default":function(){return{"default":"Not a valid IP address."}}},v4:{value:true},v6:{value:true},patterns:{"default":function(){return{v4:/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,v6:/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/}}},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(this.v4&&this.patterns.v4.test(value)){return true}else if(this.v6&&this.patterns.v6.test(value)){return true}else{return this.prepare(this.message)}}};exports.hostname={messages:{"default":function(){return{"default":"Not a valid hostname."}}},pattern:{value:/^(?:(?:(?:(?:[a-zA-Z0-9][-a-zA-Z0-9]{0,61})?[a-zA-Z0-9])[.])*(?:[a-zA-Z][-a-zA-Z0-9]{0,61}[a-zA-Z0-9]|[a-zA-Z])[.]?)$/},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}value=""+value;if(value.length>0&&value.length<=255&&this.pattern.test(value)){return true}else{return this.prepare(this.message)}}};exports.date={messages:{"default":function(){return{"default":"Not a valid date."}}},pattern:{value:/^(\d{4})-(\d{2})-(\d{2})$/},validate:function(value){var matches;if(this.allowEmpty&&this.isEmpty(value)){return true}if(value instanceof Date){return true}if(matches=this.pattern.exec(value)){if(+matches[2]<13&&+matches[3]<32){return true}}return this.prepare(this.message)}};exports.time={messages:{"default":function(){return{"default":"Not a valid time."}}},pattern:{value:/^(\d{2}):(\d{2}):(\d{2})$/},validate:function(value){var matches;if(this.allowEmpty&&this.isEmpty(value)){return true}if(value instanceof Date){return true}if(matches=this.pattern.exec(value)){if(+matches[1]<24&&+matches[2]<60&&+matches[3]<60){return true}}return this.prepare(this.message)}};exports.datetime={messages:{"default":function(){return{"default":"Not a valid date / time."}}},pattern:{value:/^(\d{4})-(\d{2})-(\d{2})[\s|T]?(\d{2}):(\d{2}):(\d{2})(?:.\d{1,3})?Z?$/},validate:function(value){var matches;if(this.allowEmpty&&this.isEmpty(value)){return true}else if(value instanceof Date){return true}else if(matches=this.pattern.exec(value)){if(+matches[2]<13&&+matches[3]<32&&+matches[4]<24&&+matches[5]<60&&+matches[6]<60){return true}}return this.prepare(this.message)}}},{obligations:7}],7:[function(_dereq_,module,exports){function PreconditionError(message,caller){this.name="PreconditionError";this.message=message||"Precondition failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||PreconditionError)}}PreconditionError.prototype=Object.create(Error.prototype);PreconditionError.prototype.constructor=PreconditionError;function PostconditionError(message,caller){this.name="PostconditionError";this.message=message||"Postcondition failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||PreconditionError)}}PostconditionError.prototype=Object.create(Error.prototype);PostconditionError.prototype.constructor=PreconditionError;function InvariantError(message,caller){this.name="InvariantError";this.message=message||"Invariant failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||InvariantError)}}InvariantError.prototype=Object.create(Error.prototype);InvariantError.prototype.constructor=InvariantError;function precondition(subject,message){if(!subject){throw new PreconditionError(message,precondition)}}function postcondition(subject,message){if(!subject){throw new PostconditionError(message,postcondition)}}function invariant(subject,message){if(!subject){throw new InvariantError(message,invariant)}}exports.PreconditionError=PreconditionError;exports.PostconditionError=PostconditionError;exports.InvariantError=InvariantError;
exports.precondition=precondition;exports.postcondition=postcondition;exports.invariant=invariant},{}]},{},[1])(1)});